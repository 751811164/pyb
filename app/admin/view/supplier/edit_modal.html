<div class="modal-dialog" role="document" style="width: 768px;">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">供应商管理</h4>
        </div>
        <div class="modal-body">
            <form class="form-horizontal">
                <input type="hidden" id="editId" name="id" data-clear value="{$info.id|default=''}">


                <ul id="myTab" class="nav nav-tabs">
                    <li class="active"><a href="#basic" data-toggle="tab">基本档案</a></li>

                    <li><a href="#picture" data-toggle="tab">上传证照</a></li>


                </ul>



                <div id="myTabContent" class="tab-content">

                    <div class="tab-pane fade in active" id="basic">
                        <!--基本信息-->

                        <div id="vm" class="row">
                            <div class="col-xs-12">


                                <div class="form-group">
                                    <label class="col-xs-2 control-label">编码</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" value="{$info.number|default=''}" disabled>
                                    </div>

                                    <label class="col-xs-2 control-label">状态</label>
                                    <div class="col-xs-4">
                                        <select name="status" class="form-control">
                                            <option value="0">停用</option>
                                            <option value="1">正在使用</option>
                                        </select>
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label class="col-xs-2 control-label">地区</label>
                                    <div class="col-xs-10">

                                        {assign name="province" value="$info.province_id|default='0'"}
                                        {assign name="city" value="$info.city_id|default='0'"}
                                        {assign name="district" value="$info.district_id|default='0'"}
                                        {:hook('RegionSelect', array('name'=>'id','province' =>$province, 'city' => $city,'district'=>$district ))}
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label class="col-xs-2 control-label">名称</label>
                                    <div class="col-xs-10">
                                        <input type="text" class="form-control" name="name" value="{$info.name|default=''}">
                                    </div>

                                </div>

                                <div class="form-group">
                                    <label class="col-xs-2 control-label">地址</label>
                                    <div class="col-xs-10">
                                        <input type="text" class="form-control" name="address" value="{$info.address|default=''}">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-xs-2 control-label">法人</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" name="legalname" value="{$info.legalname|default=''}">
                                    </div>
                                    <label class="col-xs-2 control-label">结算方式</label>
                                    <div class="col-xs-4">
                                        <select name="settlement" class="form-control">
                                            <option value="0">先款后付</option>
                                            <option value="1">货到付款</option>
                                            <option value="2">账期(月结)</option>
                                            <option value="3">账期(季度结算)</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-xs-2 control-label">手机</label>
                                    <div class="col-xs-4">
                                        <input type="number" class="form-control" name="mobile" value="{$info.mobile|default=''}">
                                    </div>

                                    <label class="col-xs-2 control-label">结算周期</label>
                                    <div class="col-xs-4">
                                        <input type="number" class="form-control" name="settlement_period" value="{$info.settlement_period|default=''}" onkeyup="this.value=this.value.replace(/\D/g,'');if(this.value>366){this.value = 366;}" onafterpaste="this.value=this.value.replace(/\D/g,'')" maxlength = 3>
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label class="col-xs-2 control-label">座机</label>
                                    <div class="col-xs-4">
                                        <input type="tel" class="form-control" name="tel" value="{$info.tel|default=''}">
                                    </div>

                                    <label class="col-xs-2 control-label">微信</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" name="wechat" value="{$info.wechat|default=''}" maxlength="366">
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label class="col-xs-2 control-label">邮箱</label>
                                    <div class="col-xs-4">
                                        <input type="email" class="form-control" name="email" value="{$info.email|default=''}">
                                    </div>

                                    <label class="col-xs-2 control-label">QQ</label>
                                    <div class="col-xs-4">
                                        <input type="number" class="form-control" name="qq" value="{$info.qq|default=''}" maxlength="366">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-xs-2 control-label">开户行</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" name="account_bank" value="{$info.account_bank|default=''}">
                                    </div>

                                    <label class="col-xs-2 control-label">户名</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" name="account_name" value="{$info.account_name|default=''}" maxlength="366">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-xs-2 control-label">账户</label>
                                    <div class="col-xs-4">
                                        <input type="number" class="form-control" name="account" value="{$info.account|default=''}">
                                    </div>
                                </div>
                                <hr>


                                <div id="contacts" class="panel panel-default">
                                    <div  class="panel-heading">联系人员<a href="javascript:;" class="btn btn-xs btn-info" @click="contactsAdd">添加</a></div>
                                    <div class="panel-body">


                                        <div class="well well-sm" v-for="(item,index) in contacts">
                                            <input type="hidden" name="@id[]" :value="item.id">
                                            <div style="overflow: hidden">
                                                <button type="button" class="close" @click="contactsDel" :data-id = "item.id" :data-index="index"  aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                            </div>
                                            <div class=" form-group form-group-sm" >
                                                <label class="col-xs-2 control-label">岗位</label>
                                                <div class="col-xs-4">
                                                    <input type="text" class="form-control"  name="@position[]" :value="item.position||''">
                                                </div>

                                                <label class="col-xs-2 control-label">手机号1</label>
                                                <div class="col-xs-4">
                                                    <input type="text" class="form-control"  name="@mobile1[]" :value="item.mobile1||''">
                                                </div>

                                                <label class="col-xs-2 control-label">姓名</label>
                                                <div class="col-xs-4">
                                                    <input type="text" class="form-control"  name="@name[]" :value="item.name||''">
                                                </div>

                                                <label class="col-xs-2 control-label">手机号2</label>
                                                <div class="col-xs-4">
                                                    <input type="text" class="form-control" name="@mobile2[]" :value="item.mobile2||''">
                                                </div>


                                                <label class="col-xs-2 control-label">微信</label>
                                                <div class="col-xs-4">
                                                    <input type="text" class="form-control"  name="@wechat[]"   :value="item.wechat||''">
                                                </div>

                                                <label class="col-xs-2 control-label">QQ</label>
                                                <div class="col-xs-4">
                                                    <input type="text" class="form-control"  name="@qq[]"   :value="item.qq||''">
                                                </div>
                                            </div>
                                        </div>




                                        <!--<div class="well well-sm">-->
                                            <!--<div style="overflow: hidden">-->
                                                <!--<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>-->
                                            <!--</div>-->
                                            <!--<div class=" form-group form-group-sm" >-->
                                                <!--<label class="col-xs-2 control-label">岗位</label>-->
                                                <!--<div class="col-xs-4">-->
                                                    <!--<input type="text" class="form-control"  name="@position[]" value="{$info.admin_add_name|default=''}">-->
                                                <!--</div>-->

                                                <!--<label class="col-xs-2 control-label">手机号1</label>-->
                                                <!--<div class="col-xs-4">-->
                                                    <!--<input type="text" class="form-control"  name="@mobile1[]" value="{$info.create_time|default=''}">-->
                                                <!--</div>-->

                                                <!--<label class="col-xs-2 control-label">姓名</label>-->
                                                <!--<div class="col-xs-4">-->
                                                    <!--<input type="text" class="form-control"  name="@name[]" value="{$info.admin_add_name|default=''}">-->
                                                <!--</div>-->

                                                <!--<label class="col-xs-2 control-label">手机号2</label>-->
                                                <!--<div class="col-xs-4">-->
                                                    <!--<input type="text" class="form-control" name="@mobile2[]" value="{$info.create_time|default=''}">-->
                                                <!--</div>-->


                                                <!--<label class="col-xs-2 control-label">微信</label>-->
                                                <!--<div class="col-xs-4">-->
                                                    <!--<input type="text" class="form-control"  name="@wechat[]"   value="{$info.create_time|default=''}">-->
                                                <!--</div>-->

                                                <!--<label class="col-xs-2 control-label">QQ</label>-->
                                                <!--<div class="col-xs-4">-->
                                                    <!--<input type="text" class="form-control"  name="@qq[]"   value="{$info.create_time|default=''}">-->
                                                <!--</div>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    </div>
                                </div>



                                <hr>


                                <div class="form-group">
                                    <label class="col-xs-2 control-label">创建人</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" disabled value="{$info.admin_add_name|default=''}">
                                    </div>

                                    <label class="col-xs-2 control-label">创建日期</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" disabled value="{$info.create_time|default=''}">
                                    </div>
                                </div>




                                <div class="form-group">

                                    <label class="col-xs-2 control-label">修改人</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" disabled value="{$info.admin_edit_name|default=''}">
                                    </div>

                                    <label class="col-xs-2 control-label">修改日期</label>
                                    <div class="col-xs-4">
                                        <input type="text" class="form-control" disabled value="{$info.update_time|default=''}">
                                    </div>
                                </div>

                            </div>


                        </div>


                    </div>


                <div class="tab-pane fade" id="picture">
                    <!--图片-->
                    <div class="row">
                        <div class="col-sm-12"><label>法人身份证</label><small>(限制1M以内)</small></div>

                        <div class="col-sm-4">
                            <div class="">
                                {assign name="identity_front_id" value="$info.identity_front_id|default='0'" /}
                                {:hook('File', ['name' => 'identity_front_id', 'value' => $identity_front_id, 'type' => 'img'])}

                                <span class="">身份证头像</span>
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="">
                                {assign name="identity_behind_id" value="$info.identity_behind_id|default='0'"
                                /}
                                {:hook('File', ['name' => 'identity_behind_id', 'value' => $identity_behind_id,  'type' => 'img'])}

                                <span class="">（身份证国徽）</span>
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="">
                                {assign name="identity_hold_id" value="$info.identity_hold_id|default='0'" /}
                                {:hook('File', ['name' => 'identity_hold_id', 'value' => $identity_hold_id,  'type' => 'img'])}

                                <span class="">（手持身份证）</span>
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-sm-12"><label>工商营业执照认证</label><small>(限制1M以内)</small></div>

                        <div class="col-sm-12">
                            <div class="">
                                {assign name="business_license_id" value="$info.business_license_id|default='0'" /}
                                {:hook('File', ['name' => 'business_license_id', 'value' => $business_license_id, 'type' => 'img'])}

                                <span class="">工商营业执照认证</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12"><label>食品药品流通许可</label><small>(限制1M以内)</small></div>

                        <div class="col-sm-12">
                            <div class="">
                                {assign name="goods_license_id" value="$info.goods_license_id|default='0'" /}
                                {:hook('File', ['name' => 'goods_license_id', 'value' => $goods_license_id,  'type' => 'img'])}

                                <span class="">食品药品流通许可</span>
                            </div>
                        </div>
                    </div>

                </div>

        </div>



            </form>
        </div>
        <div class="modal-footer">
            <!--<button type="button" id="addInfo" class="btn skin-blue-light" data-url="{:url('groupGoodsAdd')}">新增</button>-->
            <!--<button type="button" id="copyInfo" class="btn skin-blue-light" data-url="{:url('groupGoodsAdd')}">复制新增</button>-->
            <!--<button type="button" id="prevInfo" class="btn skin-blue-light" data-url="{:url('groupGoodsEdit')}">上一条</button>-->
            <!--<button type="button" id="nextInfo" class="btn skin-blue-light" data-url="{:url('groupGoodsEdit')}">下一条</button>-->
            <button type="button" id="saveInfo" class="btn skin-blue-light" data-url="{notempty name='$info.id'}{:url('supplierEdit')}{else/}{:url('supplierAdd')}{/notempty}">
                保存
            </button>
            <!--<button type="button" class="btn skin-red">下一步</button>-->
            <!--<button type="button" class="btn btn-default" hidden data-dixsiss="modal">关闭</button>-->
        </div>
    </div>
</div>
<script>
    
    var contacts={$contacts|json_encode};
    var vm = new Vue({
        el:"#contacts",
        data:{
            contacts:contacts,
        },
        methods:{
            contactsAdd:function(e){

                this.contacts.push({});
            },
            contactsDel:function(e){
                var that = this;
                var target=  e.currentTarget;
                var idx = target.getAttribute("data-index");
                var id = target.getAttribute("data-id");
                if (id) {
                    layer.confirm('此操作将已保存的记录同时删除，确定要执行吗？', function (index) {
                        ajax({
                            url:"{:url('contactDel')}",
                            data:{id:id},
                            success:function (data) {
                                obalertp(data);
                                that.contacts.splice(idx,1);
                            }
                        })
                        layer.close(index);

                    }, function (index) {
                        layer.close(index);
                    });
                }
                else {
                    this.contacts.splice(idx,1);
                }

            }
        }

    })

    $(function () {
        ob.setValue("status","{$info.status|default='0'}");
        ob.setValue("settlement","{$info.settlement|default='0'}");
    })

</script>